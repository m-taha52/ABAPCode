REPORT YCL_CH07_07_CALL_SPLIT_STRING LINE-SIZE 150.

**************************************************
* Calling Function Module YCL_CH07_SPLIT_STRING *
**************************************************
* Note on MESSAGE statement:                    *
* Exceptions raised in the function module have *
* message type 'S' (status). If an exception is *
* raised with message type 'E' (error), the      *
* program exits after returning from the        *
* function module. To avoid exiting the program *
* but still display the message as an error,    *
* use DISPLAY LIKE 'E' with the MESSAGE statement.*
**************************************************

DATA: STRG    TYPE C LENGTH 40,   " Variable to hold individual split strings
      STRGA   LIKE STANDARD TABLE OF STRG,  " Internal table to store split results
      ISTR    TYPE STRING,     " Variable to hold concatenated spell words
      ISTRD   TYPE N LENGTH 300,  " Variable to hold the split string (not used here)
      SPELL   TYPE SPELL.      " Structure to hold spell amount details

PARAMETERS: AMT TYPE P DECIMALS 2 DEFAULT '987654321.50'. " Input amount figure

START-OF-SELECTION.
  " Call function module to convert amount to words
  CALL FUNCTION 'SPELL_AMOUNT'
    EXPORTING
      AMOUNT     = AMT
      CURRENCY   = 'INR'
      FILLER     = ' '
      LANGUAGE   = SY-LANGU
    IMPORTING
      IN_WORDS   = SPELL
    EXCEPTIONS
      NOT_FOUND  = 1
      TOO_LARGE  = 2
      OTHERS    = 3.

  " Check if there was an error during SPELL_AMOUNT execution
  IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4.
    EXIT.
  ENDIF.

  " Concatenate SPELL-WORD and SPELL-DECWORD into ISTR
  CONCATENATE SPELL-WORD SPELL-DECWORD INTO ISTR SEPARATED BY ' '.

  " Call the function module to split the string
  CALL FUNCTION 'YCL_CH07_SPLIT_STRING'
    EXPORTING
      STRING_TO_SPLIT = ISTR
      STRING_TO_SPLIT = ISTRD
    TABLES
      STABLE = STRGA
    EXCEPTIONS
      IMPORT_PARAMETER_TYPE_INVALID = 1
      RETURN_TABLE_ELEMENT_NOT_TYPEC = 2
      OTHERS = 3.

  " Check if there was an error during YCL_CH07_SPLIT_STRING execution
  IF SY-SUBRC <> 0.
    MESSAGE ID SY-MSGID TYPE SY-MSGTY NUMBER SY-MSGNO
            WITH SY-MSGV1 SY-MSGV2 SY-MSGV3 SY-MSGV4
            DISPLAY LIKE 'E'.
  ELSE.
    " Output the concatenated string
    WRITE: /5 ISTR.
    SKIP 2.

    " Output each entry in the split result table
    LOOP AT STRGA INTO STRG.
      WRITE: /5 STRG.
    ENDLOOP.
  ENDIF.
